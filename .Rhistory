guides(fill = guide_legend(override.aes =
list(
pattern = c("none", "stripe", "none", "crosshatch", "none", "stripe", "none", "crosshatch", "circle"),
pattern_spacing = .01,
pattern_angle = c(0, 45, 0, 45, 0, 135, 0, 90, 45)))) +
scale_x_discrete(guide = guide_axis(n.dodge = 2))+
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
text = element_text(size= 12),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition")
ggplot(Biological_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = TRUE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
scale_x_discrete(guide = guide_axis(n.dodge = 2))+
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
ggplot(Biological_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = TRUE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
scale_x_discrete(guide = guide_axis(n.dodge = 2))+
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
ggplot(Biological_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = TRUE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
ggplot(Biological_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = TRUE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
Biological_Percetage_Transition_Graph_Color <- ggplot(Biological_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = TRUE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
ggplot(Pearson_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = TRUE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
Pearson_Percetage_Transition_Graph_Color <- ggplot(Pearson_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = TRUE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
Transition_legend_Color <- get_legend(Biological_Percetage_Transition_Graph_Color +
theme(legend.box.margin = margin(0,0,0,6)))
#make the legend
Transition_Graph_Color_Combined <- plot_grid(Biological_Percetage_Transition_Graph_Color + theme(legend.position = "none"),
Pearson_Percetage_Transition_Graph_Color + theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none"),
align = "h")
#make the combined graph
Transition_Graph_Color_Combined <- plot_grid(Transition_Graph_Color_Combined, Transition_legend_Color, rel_widths = c(3,.8)) +
theme(plot.margin = margin(60,0,30,30))
#combine the graphs and legend into one figure
Transition_Graph_Color_Combined
save.image("C:/Users/antho/OneDrive - The University of Alabama/Niche_Modeling_Rivulus/R code/Maxent_Rivulus_Climate_Change/.RData")
load("C:/Users/antho/OneDrive - The University of Alabama/Niche_Modeling_Rivulus/R code/Maxent_Rivulus_Climate_Change/.RData")
Biological_Percetage_Transition_Graph
library(tidyverse)
#for general data manipulation
library(dplyr)
#for general data manipulation
library(ggpattern)
library(broom)
#used to tidy the multinomial logistic regression outputs
library(cowplot)
#used to combine ggplot graphs
library(ENMeval)
#used for maxent modeling
library(rJava)
#to use the java application of Maxent
library(dismo)
#to project and retrieve response curves
library(raster)
#used for raster analysis
library(rgdal)
#an extension of raster to import geotiffs
library(qpcR)
# to calculate the AICw of the filtered models
library(nnet)
#to run the multinomial logistic regressions
library(sf)
#to deal with spatial objects
Biological_Percentage_Table
Biological_Percetage_Transition_Graph
Biological_Percetage_Transition_Graph_Color
Pearson_Percetage_Transition_Graph_Color
ggplot(Pearson_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = TRUE,
#labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")
) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
ggplot(Pearson_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = FALSE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")
) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
#makes a color-blind friendly graph for all nine transition categories.
Pearson_Percetage_Transition_Graph_Color <- ggplot(Pearson_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = FALSE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")
) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
#makes a color-blind friendly graph for all nine transition categories.
Transition_Graph_Combined <- plot_grid(Biological_Percetage_Transition_Graph + theme(legend.position = "none"),
Pearson_Percetage_Transition_Graph + theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none"),
align = "h")
#make the combined graph
Transition_Graph_Combined <- plot_grid(Transition_Graph_Combined, Transition_legend, rel_widths = c(3,.8)) +
theme(plot.margin = margin(60,0,30,30))
#combine the graphs and legend into one figure
Transition_legend_Color <- get_legend(Biological_Percetage_Transition_Graph_Color +
theme(legend.box.margin = margin(0,0,0,6)))
#make the legend
Transition_Graph_Color_Combined <- plot_grid(Biological_Percetage_Transition_Graph_Color + theme(legend.position = "none"),
Pearson_Percetage_Transition_Graph_Color + theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none"),
align = "h")
#make the combined graph
Transition_Graph_Color_Combined <- plot_grid(Transition_Graph_Color_Combined, Transition_legend_Color, rel_widths = c(3,.8)) +
theme(plot.margin = margin(60,0,30,30))
#combine the graphs and legend into one figure
Transition_Graph_Color_Combined
library(tidyverse)
ggplot(Pearson_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = FALSE,
#labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")
) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
ggplot(Biological_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = FALSE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
ggplot(Biological_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = FALSE,
#labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
ggplot(Biological_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = FALSE,
#labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")
) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
Biological_Percetage_Transition_Graph_Color <- ggplot(Biological_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = FALSE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")
) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
Pearson_Percetage_Transition_Graph_Color <- ggplot(Pearson_Percentage_Transitions_Table, aes(x = RCP, fill = Transition, y = Percent), color = "black") +
geom_bar(position = "stack", stat="identity") +
scale_fill_brewer(palette="Paired",
name = "Transition",
drop = FALSE,
labels = c("Medium to High", "Low to High", "Low to Medium", "High to Medium", "Medium to Low", "High to Low", "High to High", "Medium to Medium", "Low to Low")
) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
labels = c("2.6", "4.5", "6.0", "8.5")) +
labs(x = "Representative Concentration Pathway", y = "Pecentage", fill = "Transition") +
facet_wrap(.~Region, strip.position = "top", scales = "free_x")+
theme(axis.ticks.length=unit(.25, "cm"),
panel.spacing.y=unit(.5, "lines"),
panel.spacing.x=unit(0, "lines"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.background = element_blank(),
strip.text = element_text(size = 12),
strip.placement = "inside",
strip.background = element_rect(size = 0.5),
text = element_text("serif"),
axis.text.x= element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.title=element_text(size=12),
legend.text = element_text(size = 10),
legend.key.size = unit(.75, "cm"))
Transition_legend_Color <- get_legend(Biological_Percetage_Transition_Graph_Color +
theme(legend.box.margin = margin(0,0,0,6)))
#make the legend
Transition_Graph_Color_Combined <- plot_grid(Biological_Percetage_Transition_Graph_Color + theme(legend.position = "none"),
Pearson_Percetage_Transition_Graph_Color + theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none"),
align = "h")
#make the combined graph
Transition_Graph_Color_Combined <- plot_grid(Transition_Graph_Color_Combined, Transition_legend_Color, rel_widths = c(3,.8)) +
theme(plot.margin = margin(60,0,30,30))
library(cowplot)
Transition_legend_Color <- get_legend(Biological_Percetage_Transition_Graph_Color +
theme(legend.box.margin = margin(0,0,0,6)))
#make the legend
Transition_Graph_Color_Combined <- plot_grid(Biological_Percetage_Transition_Graph_Color + theme(legend.position = "none"),
Pearson_Percetage_Transition_Graph_Color + theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none"),
align = "h")
#make the combined graph
Transition_Graph_Color_Combined <- plot_grid(Transition_Graph_Color_Combined, Transition_legend_Color, rel_widths = c(3,.8)) +
theme(plot.margin = margin(60,0,30,30))
Transition_Graph_Color_Combined
